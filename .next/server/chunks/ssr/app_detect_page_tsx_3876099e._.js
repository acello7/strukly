module.exports=[30006,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(38246),e=a.i(3130),f=a.i(40695),g=a.i(210),h=a.i(13513),i=a.i(70106);let j=(0,i.default)("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]),k=(0,i.default)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),l=(0,i.default)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),m=(0,i.default)("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);var n=a.i(96221),o=a.i(46271),p=a.i(86723),q=a.i(74290),r=a.i(1703),s=a.i(14800),t=a.i(91128),u=c,v=a.i(65802);function w(a,b){if("function"==typeof a)return a(b);null!=a&&(a.current=b)}class x extends u.Component{getSnapshotBeforeUpdate(a){let b=this.props.childRef.current;if(b&&a.isPresent&&!this.props.isPresent){let a=b.offsetParent,c=(0,t.isHTMLElement)(a)&&a.offsetWidth||0,d=this.props.sizeRef.current;d.height=b.offsetHeight||0,d.width=b.offsetWidth||0,d.top=b.offsetTop,d.left=b.offsetLeft,d.right=c-d.width-d.left}return null}componentDidUpdate(){}render(){return this.props.children}}function y({children:a,isPresent:d,anchorX:e,root:f}){let g=(0,u.useId)(),h=(0,u.useRef)(null),i=(0,u.useRef)({width:0,height:0,top:0,left:0,right:0}),{nonce:j}=(0,u.useContext)(v.MotionConfigContext),k=function(...a){return c.useCallback(function(...a){return b=>{let c=!1,d=a.map(a=>{let d=w(a,b);return c||"function"!=typeof d||(c=!0),d});if(c)return()=>{for(let b=0;b<d.length;b++){let c=d[b];"function"==typeof c?c():w(a[b],null)}}}}(...a),a)}(h,a?.ref);return(0,u.useInsertionEffect)(()=>{let{width:a,height:b,top:c,left:k,right:l}=i.current;if(d||!h.current||!a||!b)return;let m="left"===e?`left: ${k}`:`right: ${l}`;h.current.dataset.motionPopId=g;let n=document.createElement("style");j&&(n.nonce=j);let o=f??document.head;return o.appendChild(n),n.sheet&&n.sheet.insertRule(`
          [data-motion-pop-id="${g}"] {
            position: absolute !important;
            width: ${a}px !important;
            height: ${b}px !important;
            ${m}px !important;
            top: ${c}px !important;
          }
        `),()=>{o.contains(n)&&o.removeChild(n)}},[d]),(0,b.jsx)(x,{isPresent:d,childRef:h,sizeRef:i,children:u.cloneElement(a,{ref:k})})}let z=({children:a,initial:d,isPresent:e,onExitComplete:f,custom:g,presenceAffectsLayout:h,mode:i,anchorX:j,root:k})=>{let l=(0,q.useConstant)(A),m=(0,c.useId)(),n=!0,o=(0,c.useMemo)(()=>(n=!1,{id:m,initial:d,isPresent:e,custom:g,onExitComplete:a=>{for(let b of(l.set(a,!0),l.values()))if(!b)return;f&&f()},register:a=>(l.set(a,!1),()=>l.delete(a))}),[e,l,f]);return h&&n&&(o={...o}),(0,c.useMemo)(()=>{l.forEach((a,b)=>l.set(b,!1))},[e]),c.useEffect(()=>{e||l.size||!f||f()},[e]),"popLayout"===i&&(a=(0,b.jsx)(y,{isPresent:e,anchorX:j,root:k,children:a})),(0,b.jsx)(s.PresenceContext.Provider,{value:o,children:a})};function A(){return new Map}var B=a.i(20410);let C=a=>a.key||"";function D(a){let b=[];return c.Children.forEach(a,a=>{(0,c.isValidElement)(a)&&b.push(a)}),b}let E=({children:a,custom:d,initial:e=!0,onExitComplete:f,presenceAffectsLayout:g=!0,mode:h="sync",propagate:i=!1,anchorX:j="left",root:k})=>{let[l,m]=(0,B.usePresence)(i),n=(0,c.useMemo)(()=>D(a),[a]),o=i&&!l?[]:n.map(C),s=(0,c.useRef)(!0),t=(0,c.useRef)(n),u=(0,q.useConstant)(()=>new Map),[v,w]=(0,c.useState)(n),[x,y]=(0,c.useState)(n);(0,r.useIsomorphicLayoutEffect)(()=>{s.current=!1,t.current=n;for(let a=0;a<x.length;a++){let b=C(x[a]);o.includes(b)?u.delete(b):!0!==u.get(b)&&u.set(b,!1)}},[x,o.length,o.join("-")]);let A=[];if(n!==v){let a=[...n];for(let b=0;b<x.length;b++){let c=x[b],d=C(c);o.includes(d)||(a.splice(b,0,c),A.push(c))}return"wait"===h&&A.length&&(a=A),y(D(a)),w(n),null}let{forceRender:E}=(0,c.useContext)(p.LayoutGroupContext);return(0,b.jsx)(b.Fragment,{children:x.map(a=>{let c=C(a),p=(!i||!!l)&&(n===x||o.includes(c));return(0,b.jsx)(z,{isPresent:p,initial:(!s.current||!!e)&&void 0,custom:d,presenceAffectsLayout:g,mode:h,root:k,onExitComplete:p?void 0:()=>{if(!u.has(c))return;u.set(c,!0);let a=!0;u.forEach(b=>{b||(a=!1)}),a&&(E?.(),y(t.current),i&&m?.(),f&&f())},anchorX:j,children:a},c)})})};async function F(a){await new Promise(a=>setTimeout(a,1500));let b=[{items:[{name:"Nasi Kuning",quantity:2,price:28e3},{name:"Ayam Goreng",quantity:1,price:35e3},{name:"Teh Panas",quantity:3,price:8e3}],total:107e3,merchant:"Warung Makan Enak",date:new Date().toLocaleDateString("id-ID")},{items:[{name:"Kopi Espresso",quantity:2,price:3e4},{name:"Croissant",quantity:1,price:25e3},{name:"Mineral Water",quantity:2,price:5e3}],total:95e3,merchant:"Coffee Corner",date:new Date().toLocaleDateString("id-ID")},{items:[{name:"Soto Ayam",quantity:1,price:32e3},{name:"Perkedel",quantity:2,price:15e3},{name:"Es Jeruk",quantity:1,price:1e4}],total:72e3,merchant:"Soto Ayam Bpk Hasan",date:new Date().toLocaleDateString("id-ID")}];return b[Math.floor(Math.random()*b.length)]}var G=a.i(82145),H=a.i(67129),I=a.i(60486),J=a.i(21937),K=a.i(50944),L=a.i(2288);a.i(60121);var M=a.i(5420),N=a.i(18740);async function O(a,b){let c=Date.now(),d=`${b}/${c}_${a.name}`,e=(0,M.ref)(N.storage,`receipts/${d}`),f=await (0,M.uploadBytes)(e,a);return await (0,M.getDownloadURL)(f.ref)}var P=a.i(23292),Q=a.i(32634);function R(){let{language:a}=(0,G.useLanguage)(),i=H.translations[a],{user:p,loading:q}=(0,J.useAuth)(),r=(0,K.useRouter)(),[s,t]=(0,c.useState)(null),[u,v]=(0,c.useState)(null),[w,x]=(0,c.useState)([]),[y,z]=(0,c.useState)([]),[A,B]=(0,c.useState)(null),[C,D]=(0,c.useState)(null),[M,N]=(0,c.useState)(!1),[R,S]=(0,c.useState)(!1),[T,U]=(0,c.useState)(""),V=(0,c.useRef)(null);if((0,c.useEffect)(()=>{q||p||r.push("/login")},[p,q,r]),q)return(0,b.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,b.jsx)(n.Loader2,{className:"w-8 h-8 animate-spin text-primary"})});if(!p)return null;let W=async b=>{let c=b.target.files?.[0];if(c){v(c);let b=new FileReader;b.onloadend=async()=>{t(b.result),N(!0);try{let a=await F(b.result);x(a.items.map((a,b)=>{var c;return{id:b.toString(),name:({nasi_goreng:"Nasi Goreng",mie_goreng:"Mie Goreng",soto_ayam:"Soto Ayam",gado_gado:"Gado-Gado",perkedel:"Perkedel",lumpia:"Lumpia",kopi:"Kopi",teh:"Teh",es:"Es",air:"Air Mineral"})[(c=a.name).toLowerCase().replace(/\s+/g,"_")]||c,quantity:a.quantity,price:a.price}})),U(a.merchant)}catch(b){console.error("OCR detection error:",b),P.toast.error("id"===a?"Gagal mendeteksi struk":"Failed to detect receipt")}finally{N(!1)}},b.readAsDataURL(c)}},X=()=>{C&&(x(w.map(a=>a.id===A?C:a)),B(null),D(null))},Y=w.reduce((a,b)=>a+b.quantity*b.price,0),Z=async()=>{if(0!==w.length&&p&&u){S(!0);try{let b=await O(u,p.uid);await (0,L.createReceipt)({userId:p.uid,imageUrl:b,storeName:T||("id"===a?"Merchant Tidak Diketahui":"Unknown Merchant"),date:new Date().toISOString().split("T")[0],totalAmount:Y,items:w.map(a=>({name:a.name,quantity:a.quantity,price:a.price,total:a.quantity*a.price})),category:"General",paymentMethod:"Cash"}),P.toast.success("id"===a?"Struk berhasil disimpan!":"Receipt saved successfully!"),t(null),v(null),x([]),U(""),setTimeout(()=>{r.push("/revenue")},1e3)}catch(b){console.error("Save receipt error:",b),P.toast.error(b.message||("id"===a?"Gagal menyimpan struk":"Failed to save receipt"))}finally{S(!1)}}};return(0,b.jsxs)("main",{className:"min-h-screen bg-gradient-to-br from-background via-background to-primary/5",children:[(0,b.jsx)("nav",{className:"sticky top-0 z-50 bg-background/95 backdrop-blur-sm border-b border-border",children:(0,b.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,b.jsxs)("div",{className:"flex items-center justify-between h-16",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)(d.default,{href:"/",children:(0,b.jsx)(f.Button,{variant:"ghost",size:"icon",children:(0,b.jsx)(g.ArrowLeft,{className:"w-4 h-4"})})}),(0,b.jsx)("h1",{className:"text-xl font-bold",children:i.ambil_foto_struk})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(I.LanguageToggle,{}),(0,b.jsx)(d.default,{href:"/revenue",children:(0,b.jsx)(f.Button,{variant:"outline",children:i.laporan})}),(0,b.jsx)(Q.UserNav,{})]})]})})}),(0,b.jsx)("section",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,b.jsxs)(o.motion.div,{className:"grid md:grid-cols-2 gap-8",initial:{opacity:0},animate:{opacity:1},children:[(0,b.jsxs)(o.motion.div,{className:"space-y-4",initial:{x:-20,opacity:0},animate:{x:0,opacity:1},children:[(0,b.jsx)("h2",{className:"text-2xl font-bold",children:i.ambil_foto_struk}),(0,b.jsx)(e.Card,{className:"border-border/50 border-2 border-dashed p-8 cursor-pointer hover:border-primary/50 transition-colors",children:(0,b.jsxs)("label",{className:"cursor-pointer block",children:[(0,b.jsx)("input",{ref:V,type:"file",accept:"image/*",onChange:W,className:"hidden"}),s?(0,b.jsxs)(o.motion.div,{className:"space-y-4",initial:{opacity:0},animate:{opacity:1},children:[(0,b.jsx)("img",{src:s||"/placeholder.svg",alt:i.ganti_foto,className:"w-full rounded-lg max-h-96 object-cover"}),(0,b.jsx)(f.Button,{variant:"outline",className:"w-full bg-transparent",onClick:a=>{a.preventDefault(),t(null),x([]),U("")},children:i.ganti_foto})]}):(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center gap-4 py-8",children:[(0,b.jsx)(o.motion.div,{animate:{y:[0,-5,0]},transition:{duration:2,repeat:1/0},children:(0,b.jsx)(h.Camera,{className:"w-12 h-12 text-primary"})}),(0,b.jsxs)("div",{className:"text-center space-y-2",children:[(0,b.jsx)("p",{className:"font-semibold",children:i.klik_drag}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:i.png_jpg})]})]})]})})]}),(0,b.jsxs)(o.motion.div,{className:"space-y-4",initial:{x:20,opacity:0},animate:{x:0,opacity:1},children:[(0,b.jsx)("h2",{className:"text-2xl font-bold",children:i.data_terdeteksi}),(0,b.jsxs)(e.Card,{className:"border-border/50 p-6 space-y-4",children:[T&&(0,b.jsxs)(o.motion.div,{className:"p-3 bg-primary/10 rounded-lg border border-primary/20",initial:{opacity:0},animate:{opacity:1},children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:i.merchant}),(0,b.jsx)("p",{className:"font-semibold text-primary",children:T})]}),M&&(0,b.jsxs)(o.motion.div,{className:"flex items-center gap-2 py-4 justify-center",initial:{opacity:0},animate:{opacity:1},children:[(0,b.jsx)(n.Loader2,{className:"w-4 h-4 animate-spin text-primary"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:i.mendeteksi_struk})]}),(0,b.jsx)(E,{children:(0,b.jsx)("div",{className:"space-y-2",children:w.map((a,c)=>(0,b.jsx)(o.motion.div,{className:"space-y-2",initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{delay:.05*c},children:A===a.id?(0,b.jsxs)("div",{className:"space-y-2 p-4 bg-muted/30 rounded-lg border border-border",children:[(0,b.jsx)("input",{type:"text",value:C?.name||"",onChange:a=>D(C?{...C,name:a.target.value}:null),className:"w-full px-3 py-2 bg-background border border-border rounded text-sm",placeholder:i.email}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)("input",{type:"number",value:C?.quantity||0,onChange:a=>D(C?{...C,quantity:Number.parseInt(a.target.value)||0}:null),className:"flex-1 px-3 py-2 bg-background border border-border rounded text-sm",placeholder:i.qty}),(0,b.jsx)("input",{type:"number",value:C?.price||0,onChange:a=>D(C?{...C,price:Number.parseInt(a.target.value)||0}:null),className:"flex-1 px-3 py-2 bg-background border border-border rounded text-sm",placeholder:i.harga})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(f.Button,{size:"sm",className:"flex-1 bg-primary text-white hover:bg-primary/90",onClick:X,children:[(0,b.jsx)(m,{className:"w-4 h-4 mr-1"})," ",i.simpan]}),(0,b.jsx)(f.Button,{size:"sm",variant:"outline",className:"flex-1 bg-transparent",onClick:()=>B(null),children:i.batal})]})]}):(0,b.jsxs)("div",{className:"flex items-center justify-between p-3 bg-muted/30 rounded-lg hover:bg-muted/50 transition-colors",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"font-medium",children:a.name}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:[a.quantity,"x @ Rp ",a.price.toLocaleString("id-ID")]}),(0,b.jsxs)("p",{className:"font-semibold text-primary",children:["Rp ",(a.quantity*a.price).toLocaleString("id-ID")]})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(f.Button,{size:"icon",variant:"ghost",onClick:()=>{B(a.id),D({...a})},children:(0,b.jsx)(j,{className:"w-4 h-4"})}),(0,b.jsx)(f.Button,{size:"icon",variant:"ghost",onClick:()=>{var b;return b=a.id,void x(w.filter(a=>a.id!==b))},children:(0,b.jsx)(l,{className:"w-4 h-4 text-destructive"})})]})]})},a.id))})}),(0,b.jsxs)(f.Button,{variant:"outline",className:"w-full bg-transparent",onClick:()=>{x([...w,{id:Date.now().toString(),name:"Item Baru",quantity:1,price:0}])},children:[(0,b.jsx)(k,{className:"w-4 h-4 mr-2"})," ",i.tambah_item]}),w.length>0&&(0,b.jsxs)("div",{className:"border-t border-border pt-4 space-y-3",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsx)("span",{className:"text-lg font-semibold",children:i.total}),(0,b.jsxs)("span",{className:"text-2xl font-bold text-primary",children:["Rp ",Y.toLocaleString("id-ID")]})]}),(0,b.jsx)(f.Button,{className:"w-full bg-primary hover:bg-primary/90 text-white",onClick:Z,disabled:M||R,children:R?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(n.Loader2,{className:"w-4 h-4 mr-2 animate-spin"}),"id"===a?"Menyimpan...":"Saving..."]}):i.simpan_database})]})]})]})]})})]})}a.s(["default",()=>R],30006)}];

//# sourceMappingURL=app_detect_page_tsx_3876099e._.js.map